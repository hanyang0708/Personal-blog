(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-80397ba0"],{3259:function(t,e,i){},"3b51":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"flex flex-column"},[i("div",{staticClass:"flex-1 flex flex-column height-0"},[i("mavon-editor",{ref:"md",staticStyle:{height:"100%",flex:"1","box-shadow":"rgba(0, 0, 0, 0.1) 0px 0px 12px 0px"},attrs:{ishljs:"",scrollStyle:!0},on:{change:t.mdChange,imgAdd:t.$imgAdd},model:{value:t.mdCon,callback:function(e){t.mdCon=e},expression:"mdCon"}})],1),i("div",{staticClass:"footer"},[i("el-button",{staticStyle:{width:"100px"},on:{click:t.onCancelClick}},[t._v("取消")]),i("el-button",{staticClass:"ml-20",staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:t.onSaveClick}},[t._v("发布")])],1),i("el-dialog",{attrs:{title:"文章标题",visible:t.centerDialogVisible,width:"30%","destroy-on-close":""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[i("el-input",{attrs:{placeholder:"请输入文章标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:t.submitClick}},[t._v("确 定")])],1)],1)],1)},s=[],o=(i("c975"),i("b0c0"),i("b2d8")),a=(i("64e1"),i("365c")),l={props:["id"],data:function(){return{centerDialogVisible:!1,mdCon:"",title:"",preview:""}},methods:{mdChange:function(t,e){var i=document.createElement("div");i.innerHTML=e,this.preview=i.innerText.substr(0,100)},onCancelClick:function(){this.$router.go(-1)},$imgAdd:function(t,e){var i=this,n=(new Date).getTime();this.getUploadUrl(n+e.name,e,(function(e){e=e.substring(0,e.indexOf("?")),i.$refs.md.$img2Url(t,e)}))},onSaveClick:function(){this.centerDialogVisible=!0},submitClick:function(){var t=this;this.id?a["a"].updateEssay({id:this.id,title:this.title,preview:this.preview,content:this.mdCon,userId:this.$store.getters.getUserId}).then((function(e){t.$message.success("编辑成功！感谢您的分享"),t.$router.go(-1)})):a["a"].createEssay({title:this.title,preview:this.preview,content:this.mdCon,userId:this.$store.getters.getUserId}).then((function(e){t.$message.success("发布成功！感谢您的分享"),t.$router.push({path:"/"})})).catch((function(e){t.$message.error("发布失败，请稍后重试！")}))},getUploadUrl:function(t,e,i){var n=this;a["b"].getUploadUrl({name:t,type:2}).then((function(t){a["b"].uploadImg(t.data.url,e).then((function(e){i(t.data.url)})).catch((function(){n.$message.error("图片上传失败")}))}))},queryEssayById:function(){var t=this;a["a"].queryEssayById({id:this.id}).then((function(e){t.mdCon=e.data.content,t.title=e.data.title}))}},created:function(){this.id&&this.queryEssayById()},components:{mavonEditor:o["mavonEditor"]}},c=l,r=(i("4edd"),i("2877")),d=Object(r["a"])(c,n,s,!1,null,"43f2b1d4",null);e["default"]=d.exports},"4edd":function(t,e,i){"use strict";var n=i("3259"),s=i.n(n);s.a}}]);