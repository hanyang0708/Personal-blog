{"version":3,"sources":["webpack:///./src/views/CreateEssay.vue?a3ee","webpack:///src/views/CreateEssay.vue","webpack:///./src/views/CreateEssay.vue?cec0","webpack:///./src/views/CreateEssay.vue","webpack:///./src/views/CreateEssay.vue?20d1"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","staticStyle","attrs","on","mdChange","$imgAdd","model","value","callback","$$v","mdCon","expression","onCancelClick","_v","onSaveClick","centerDialogVisible","$event","title","slot","submitClick","staticRenderFns","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,oBAAoB,CAACF,EAAG,MAAM,CAACE,YAAY,oCAAoC,CAACF,EAAG,eAAe,CAACG,IAAI,KAAKC,YAAY,CAAC,OAAS,OAAO,KAAO,IAAI,aAAa,uCAAuCC,MAAM,CAAC,OAAS,GAAG,aAAc,GAAMC,GAAG,CAAC,OAASV,EAAIW,SAAS,OAASX,EAAIY,SAASC,MAAM,CAACC,MAAOd,EAAS,MAAEe,SAAS,SAAUC,GAAMhB,EAAIiB,MAAMD,GAAKE,WAAW,YAAY,GAAGd,EAAG,MAAM,CAACE,YAAY,UAAU,CAACF,EAAG,YAAY,CAACI,YAAY,CAAC,MAAQ,SAASE,GAAG,CAAC,MAAQV,EAAImB,gBAAgB,CAACnB,EAAIoB,GAAG,QAAQhB,EAAG,YAAY,CAACE,YAAY,QAAQE,YAAY,CAAC,MAAQ,SAASC,MAAM,CAAC,KAAO,WAAWC,GAAG,CAAC,MAAQV,EAAIqB,cAAc,CAACrB,EAAIoB,GAAG,SAAS,GAAGhB,EAAG,YAAY,CAACK,MAAM,CAAC,MAAQ,OAAO,QAAUT,EAAIsB,oBAAoB,MAAQ,MAAM,mBAAmB,IAAIZ,GAAG,CAAC,iBAAiB,SAASa,GAAQvB,EAAIsB,oBAAoBC,KAAU,CAACnB,EAAG,WAAW,CAACK,MAAM,CAAC,YAAc,WAAWI,MAAM,CAACC,MAAOd,EAAS,MAAEe,SAAS,SAAUC,GAAMhB,EAAIwB,MAAMR,GAAKE,WAAW,WAAWd,EAAG,OAAO,CAACE,YAAY,gBAAgBG,MAAM,CAAC,KAAO,UAAUgB,KAAK,UAAU,CAACrB,EAAG,YAAY,CAACM,GAAG,CAAC,MAAQ,SAASa,GAAQvB,EAAIsB,qBAAsB,KAAS,CAACtB,EAAIoB,GAAG,SAAShB,EAAG,YAAY,CAACK,MAAM,CAAC,KAAO,WAAWC,GAAG,CAAC,MAAQV,EAAI0B,cAAc,CAAC1B,EAAIoB,GAAG,UAAU,IAAI,IAAI,IACr0CO,EAAkB,G,0DCyCtB,GACE,MAAF,OACE,KAFF,WAGI,MAAJ,CACM,qBAAN,EACM,MAAN,GACM,MAAN,GACM,QAAN,KAGE,QAAF,CACI,SADJ,SACA,KACM,QAAN,eACM,IAAN,gCACM,EAAN,YACM,KAAN,mCAEI,cAPJ,WAQM,KAAN,gBAEI,QAVJ,SAUA,KAAM,IAAN,OACA,uBACM,KAAN,qCACQ,EAAR,8BACQ,EAAR,2BAGI,YAjBJ,WAkBM,KAAN,wBAEI,YApBJ,WAoBM,IAAN,OACA,QACQ,EAAR,kBACU,GAAV,QACU,MAAV,WACU,QAAV,aACU,QAAV,WACU,OAAV,gCACA,kBACU,EAAV,gCACU,EAAV,kBAKM,EAAN,kBACQ,MAAR,WACQ,QAAR,aACQ,QAAR,WACQ,OAAR,gCACA,kBACQ,QAAR,cACQ,EAAR,gCACQ,EAAR,cAAU,KAAV,SACA,mBACQ,QAAR,kBAGI,aAhDJ,SAgDA,OAAM,IAAN,OACM,EAAN,mBACQ,KAAR,EACQ,KAAR,IACA,kBACQ,QAAR,OACQ,EAAR,+CACU,EAAV,eACA,kBACU,EAAV,+BAEA,mBACQ,QAAR,WAGI,eA/DJ,WA+DM,IAAN,OACM,EAAN,qBACQ,GAAR,UACA,kBACQ,EAAR,qBACQ,EAAR,wBAIE,QAlFF,WAmFA,SACM,KAAN,kBAGE,WAAF,CACI,YAAJ,mBClIqV,I,wBCQjVC,EAAY,eACd,EACA7B,EACA4B,GACA,EACA,KACA,WACA,MAIa,aAAAC,E,6CCnBf,yBAA0e,EAAG,G","file":"js/chunk-4631412b.278988a2.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"flex flex-column\"},[_c('div',{staticClass:\"flex-1 flex flex-column height-0\"},[_c('mavon-editor',{ref:\"md\",staticStyle:{\"height\":\"100%\",\"flex\":\"1\",\"box-shadow\":\"rgba(0, 0, 0, 0.1) 0px 0px 12px 0px\"},attrs:{\"ishljs\":\"\",\"scrollStyle\":true},on:{\"change\":_vm.mdChange,\"imgAdd\":_vm.$imgAdd},model:{value:(_vm.mdCon),callback:function ($$v) {_vm.mdCon=$$v},expression:\"mdCon\"}})],1),_c('div',{staticClass:\"footer\"},[_c('el-button',{staticStyle:{\"width\":\"100px\"},on:{\"click\":_vm.onCancelClick}},[_vm._v(\"取消\")]),_c('el-button',{staticClass:\"ml-20\",staticStyle:{\"width\":\"100px\"},attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onSaveClick}},[_vm._v(\"发布\")])],1),_c('el-dialog',{attrs:{\"title\":\"文章标题\",\"visible\":_vm.centerDialogVisible,\"width\":\"30%\",\"destroy-on-close\":\"\"},on:{\"update:visible\":function($event){_vm.centerDialogVisible=$event}}},[_c('el-input',{attrs:{\"placeholder\":\"请输入文章标题\"},model:{value:(_vm.title),callback:function ($$v) {_vm.title=$$v},expression:\"title\"}}),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.centerDialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.submitClick}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class='flex flex-column'>\n        <div class=\"flex-1 flex flex-column height-0\">\n            <mavon-editor \n                v-model=\"mdCon\" \n                ref=\"md\" \n                @change=\"mdChange\" \n                style=\"height: 100%;flex:1;box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 12px 0px;\"\n                @imgAdd=\"$imgAdd\"\n                ishljs\n                :scrollStyle='true'\n            />\n        </div>\n\n        <div class='footer'>\n            <el-button style=\"width:100px\" @click=\"onCancelClick\">取消</el-button>\n            <el-button type=\"primary\" style=\"width:100px\" class=\"ml-20\" @click=\"onSaveClick\">发布</el-button>\n        </div>\n\n        <el-dialog\n            title=\"文章标题\"\n            :visible.sync=\"centerDialogVisible\"\n            width=\"30%\"\n            destroy-on-close\n        >\n            <el-input\n                placeholder=\"请输入文章标题\"\n                v-model=\"title\"\n            />\n            <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button @click=\"centerDialogVisible = false\">取 消</el-button>\n                <el-button type=\"primary\" @click=\"submitClick\">确 定</el-button>\n            </span>\n        </el-dialog>\n    </div>\n</template>\n\n<script>\nimport { mavonEditor } from 'mavon-editor'\nimport 'mavon-editor/dist/css/index.css'\nimport { essayService, uploadService } from '@/api'\n\nexport default {\n    props:['id'],\n    data() {\n        return {\n            centerDialogVisible: false,\n            mdCon: '',\n            title: '',\n            preview: ''\n        }\n    },\n    methods: {\n        mdChange(value,render) {\n            console.log(value,'value');\n            var div = document.createElement(\"div\");\n            div.innerHTML = render;\n            this.preview = div.innerText.substr(0,100);\n        },\n        onCancelClick() {\n            this.$router.go(-1);\n        },\n        $imgAdd(pos, $file){\n            let date = new Date().getTime();\n            this.getUploadUrl(date + $file.name, $file,(url)=>{\n                url = url.substring(0, url.indexOf('?'))\n                this.$refs.md.$img2Url(pos, url);\n            });\n        },\n        onSaveClick() {\n            this.centerDialogVisible = true;\n        },\n        submitClick() {\n            if(this.id){\n                essayService.updateEssay({\n                    id: this.id,\n                    title: this.title, \n                    preview: this.preview, \n                    content: this.mdCon, \n                    userId: this.$store.getters.getUserId\n                }).then(res=>{\n                    this.$message.success('编辑成功！感谢您的分享');\n                    this.$router.go(-1);\n                })\n\n                return\n            }\n            essayService.createEssay({\n                title: this.title, \n                preview: this.preview, \n                content: this.mdCon, \n                userId: this.$store.getters.getUserId\n            }).then(res=>{\n                console.log(res,'创建成功')\n                this.$message.success('发布成功！感谢您的分享');\n                this.$router.push({path:'/'});\n            }).catch(err=>{\n                console.log(err,'创建失败')\n            })\n        },\n        getUploadUrl(name,file,callBack) {\n            uploadService.getUploadUrl({\n                name,\n                type: 2\n            }).then(res=>{\n                console.log(res);\n                uploadService.uploadImg(res.data.url,file).then(response=>{\n                    callBack(res.data.url);\n                }).catch(()=>{\n                    this.$message.error('图片上传失败');\n                })\n            }).catch(err=>{\n                console.log(err);\n            })\n        },\n        queryEssayById() {\n            essayService.queryEssayById({\n                id: this.id\n            }).then(res=>{\n                this.mdCon = res.data.content;\n                this.title = res.data.title;\n            })\n        }\n    },\n    created(){\n        if(this.id){\n            this.queryEssayById();\n        }\n    },\n    components: {\n        mavonEditor,\n    }\n}\n</script>\n\n<style scoped>\n    .footer {\n        text-align: right;\n        padding: 20px 0px;\n    }\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateEssay.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateEssay.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CreateEssay.vue?vue&type=template&id=2784f27b&scoped=true&\"\nimport script from \"./CreateEssay.vue?vue&type=script&lang=js&\"\nexport * from \"./CreateEssay.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CreateEssay.vue?vue&type=style&index=0&id=2784f27b&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2784f27b\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateEssay.vue?vue&type=style&index=0&id=2784f27b&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CreateEssay.vue?vue&type=style&index=0&id=2784f27b&scoped=true&lang=css&\""],"sourceRoot":""}